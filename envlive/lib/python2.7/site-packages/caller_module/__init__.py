#!/usr/bin/env python
import inspect
from public import public

# for frame, filename, line_number, function_name, lines, index in frames:


@public
def caller_modules():
    frames = inspect.getouterframes(inspect.currentframe())[1:]
    modules = []
    for frame, _, _, _, _, _ in frames:
        module = inspect.getmodule(frame)
        if module and module in modules:
            modules.append(module)
    return modules


@public
def caller_module(depth=0):
    modules = caller_modules()[1:]  # exclude parent module
    if depth < len(modules):
        return modules[depth]
